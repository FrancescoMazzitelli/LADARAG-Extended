openapi: 3.0.2
info:
  title: Smart Charging Stations API
  version: 1.0
  description: |-
    Smart Charging Stations API for managing electric vehicle charging points in the city. Compatible with the City Energy Grid System, this service allows interaction with charging station references.
    Supports creation, lookup, update, and deletion of charging stations including availability and pricing information.
  contact:
    name: Smart City Development Team

servers:
  - url: http://localhost:8585/rest/Smart+Charging+Stations+API/1.0
    description: Mock server generated by Microcks

components:
  schemas:
    ResponseStatus:
      type: object
      properties:
        status:
          type: string
        httpCode:
          type: integer
        message:
          type: string
      required:
        - status
        - httpCode
        - message

    ChargingStation:
      allOf:
        - $ref: '#/components/schemas/NewChargingStation'
        - properties:
            id:
              type: integer
              format: int64
              description: Unique identifier for the charging station
          required:
            - id

    NewChargingStation:
      type: object
      properties:
        location:
          type: string
          description: Physical location of the charging station
        available:
          type: boolean
          description: Is the charging station currently available
        connectors:
          type: integer
          description: Number of available connectors
        chargingSpeed:
          type: string
          enum: [slow, fast, rapid]
          description: Charging speed category
        pricePerKWh:
          type: number
          format: float
          description: Price per kilowatt-hour (kWh) in local currency
      required:
        - location
        - available
        - connectors
        - chargingSpeed
        - pricePerKWh

paths:
  /health:
    get:
      description: Health check
      responses:
        "200":
          content:
            application/json:
              schema:
                type: object
              examples:
                healthy:
                  value: {}

  /charging-station:
    get:
      description: List all charging stations
      responses:
        "200":
          description: List of all charging stations
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/ChargingStation'
              examples:
                example_list:
                  value:
                    - id: 1
                      location: "123 Electric Ave"
                      available: true
                      connectors: 4
                      chargingSpeed: fast
                      pricePerKWh: 0.25
                    - id: 2
                      location: "456 Green St"
                      available: false
                      connectors: 2
                      chargingSpeed: rapid
                      pricePerKWh: 0.35

    post:
      description: Create a new charging station entry
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/NewChargingStation'
            examples:
              new_station:
                value:
                  location: "789 Battery Blvd"
                  available: true
                  connectors: 6
                  chargingSpeed: slow
                  pricePerKWh: 0.20
      responses:
        "201":
          description: Charging station created
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ChargingStation'
              examples:
                created:
                  value:
                    id: 3
                    location: "789 Battery Blvd"
                    available: true
                    connectors: 6
                    chargingSpeed: slow
                    pricePerKWh: 0.20

  /charging-station/{id}:
    get:
      description: Get a charging station by its ID (used as reference in City Energy Grid System)
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
            format: int64
          examples:
            station_1:
              value: 1
      responses:
        "200":
          description: Charging station details
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ChargingStation'
              examples:
                station_1:
                  value:
                    id: 1
                    location: "123 Electric Ave"
                    available: true
                    connectors: 4
                    chargingSpeed: fast
                    pricePerKWh: 0.25
        "404":
          description: Charging station not found

    put:
      description: Update a charging station by ID
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
          examples:
            updated:
              value: 1
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/NewChargingStation'
            examples:
              update:
                value:
                  location: "123 Electric Ave"
                  available: false
                  connectors: 3
                  chargingSpeed: fast
                  pricePerKWh: 0.28
      responses:
        "200":
          description: Charging station updated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ChargingStation'
              examples:
                updated:
                  value:
                    id: 1
                    location: "123 Electric Ave"
                    available: false
                    connectors: 3
                    chargingSpeed: fast
                    pricePerKWh: 0.28
        "404":
          description: Charging station not found

    delete:
      description: Delete a charging station by ID
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
          examples:
            deleted:
              value: 1
      responses:
        "204":
          description: Deleted successfully
          content:
            text/plain:
              examples:
                deleted:
                  value: "Charging station deleted"
        "404":
          description: Charging station not found

  /register:
    post:
      description: Register this service to the discovery system
      responses:
        "200":
          description: Registration success
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ResponseStatus'
              examples:
                ok:
                  value:
                    status: "success"
                    httpCode: 200
                    message: "Service registered"
        "500":
          description: Registration failure
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ResponseStatus'
              examples:
                fail:
                  value:
                    status: "error"
                    httpCode: 500
                    message: "Unable to register to Consul"
